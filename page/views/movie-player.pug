extends layout

block content
  div(class="container mx-auto px-6 py-8")
    div(class="grid grid-cols-1 lg:grid-cols-4 gap-8")
      div(class="lg:col-span-3")
        // Breadcrumb Navigation
        nav(class="mb-8")
          ol(class="flex items-center space-x-3 text-sm text-gray-500 dark:text-gray-400")
            li: a(href="/" class="hover:text-orange-600 dark:hover:text-orange-400 transition-colors duration-200 flex items-center")
              svg(class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6")
              span Beranda
            li: span(class="text-gray-400 dark:text-gray-500") /
            li: a(href=`/` class="hover:text-orange-600 dark:hover:text-orange-400 transition-colors duration-200")= anime.title

        // Video Player Section
        div(class="bg-gradient-to-br from-gray-900 to-black rounded-3xl overflow-hidden shadow-2xl mb-8 group transition-all duration-500 hover:shadow-3xl")
          div(class="aspect-video relative")
            iframe(class="w-full h-full" src=`${anime.stream_url}` frameborder="0" allow="autoplay; fullscreen" allowfullscreen)
            div(class="absolute inset-0 bg-gradient-to-t from-transparent via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300")

      div(class="lg:col-span-1")
        // Anime Info Section
        div(class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl rounded-3xl shadow-xl p-8 mb-8 border border-white/20 dark:border-gray-700/30 transition-all duration-500 hover:shadow-2xl")
          a(href=`/anime/${anime.slug}` class="block group")
            div(class="relative overflow-hidden rounded-2xl mb-6")
              img(src=anime.poster alt=anime.title class="w-full aspect-[3/4] object-cover transition-transform duration-500 group-hover:scale-105" onerror="this.onerror=null;this.src='https://placehold.co/400x600?text=No+Image';")
              div(class="absolute inset-0 bg-gradient-to-t from-black/50 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300")
          h3(class="font-bold text-gray-900 dark:text-gray-100 mb-4 text-xl")
            a(href=`/anime/${anime.slug}` class="hover:text-orange-600 dark:hover:text-orange-400 transition-colors duration-300")= anime.title

        // Share Section Sidebar
        div(class="bg-white/90 dark:bg-gray-800/90 backdrop-blur-xl rounded-3xl shadow-xl p-8 border border-white/30 dark:border-gray-600/40 transition-all duration-500 hover:shadow-2xl")
          h3(class="font-bold text-gray-800 dark:text-gray-100 mb-6 flex items-center text-lg")
            svg(class="w-6 h-6 mr-3 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z")
            span Bagikan
          div(class="space-y-4")
            button(onclick="shareEpisode()" class="w-full bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg flex items-center justify-center space-x-2")
              svg(class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z")
              span Bagikan Episode
            button(onclick="copyEpisodeLink()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-300 hover:scale-105 hover:shadow-lg flex items-center justify-center space-x-2")
              svg(class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z")
              span Copy Link

  // Scroll to Top Button
  button(id="scrollToTop" class="fixed bottom-8 right-8 bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-600 hover:to-red-700 text-white p-4 rounded-full shadow-2xl hover:shadow-orange-500/25 transition-all duration-300 hover:scale-110 opacity-0 invisible z-50")
    svg(class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24")
      path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18")

block scripts
  script.
    // Enhanced video player functionality
    document.addEventListener('DOMContentLoaded', function() {
      const videoPlayer = document.querySelector('video');
      if (videoPlayer) {
        // Add custom controls if needed
        videoPlayer.addEventListener('play', function() {
          console.log('Video started playing');
        });
      }
    });

    // Smooth scrolling functionality
    document.addEventListener('DOMContentLoaded', function() {
      // Smooth scroll for all internal links
      document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
          e.preventDefault();
          const target = document.querySelector(this.getAttribute('href'));
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
      });

      // Scroll to top button functionality
      const scrollToTopBtn = document.getElementById('scrollToTop');
      
      // Show/hide scroll to top button
      window.addEventListener('scroll', function() {
        if (window.pageYOffset > 300) {
          scrollToTopBtn.classList.remove('opacity-0', 'invisible');
          scrollToTopBtn.classList.add('opacity-100', 'visible');
        } else {
          scrollToTopBtn.classList.add('opacity-0', 'invisible');
          scrollToTopBtn.classList.remove('opacity-100', 'visible');
        }
      });

      // Smooth scroll to top when button is clicked
      scrollToTopBtn.addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });

      // Enhanced smooth scroll for all links
      document.querySelectorAll('a').forEach(link => {
        if (link.href && link.href.includes(window.location.origin)) {
          link.addEventListener('click', function(e) {
            // Only apply smooth scroll for same-page navigation
            if (this.href.includes('#')) {
              e.preventDefault();
              const targetId = this.href.split('#')[1];
              const targetElement = document.getElementById(targetId);
              if (targetElement) {
                targetElement.scrollIntoView({
                  behavior: 'smooth',
                  block: 'start'
                });
              }
            }
          });
        }
      });
    });

    // Smooth scroll behavior for the entire page
    document.documentElement.style.scrollBehavior = 'smooth';
    
    // Enhanced scroll animations (removed parallax for better performance)
    window.addEventListener('scroll', function() {
      // Hero section is now fixed, no parallax effect
      // This prevents lag during scrolling
    });

    // Smooth scroll for mobile devices
    if ('ontouchstart' in window) {
      document.documentElement.style.scrollBehavior = 'smooth';
    }

    // Enhanced share functionality
    function shareEpisode() {
      if (navigator.share) {
        navigator.share({
          title: 'Tonton Movie Anime',
          text: 'Tonton movie anime favorit Anda di KitaNime',
          url: window.location.href
        });
      } else {
        copyEpisodeLink();
      }
    }

    function copyEpisodeLink() {
      const url = window.location.href;
      if (navigator.clipboard) {
        navigator.clipboard.writeText(url).then(() => {
          showNotification('Link berhasil disalin!', 'success');
        });
      } else {
        fallbackCopyTextToClipboard(url);
      }
    }

    function fallbackCopyTextToClipboard(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      document.body.appendChild(textArea);
      textArea.focus();
      textArea.select();
      
      try {
        document.execCommand('copy');
        showNotification('Link berhasil disalin!', 'success');
      } catch (err) {
        showNotification('Gagal menyalin link', 'error');
      }
      
      document.body.removeChild(textArea);
    }

    function showNotification(message, type) {
      const notification = document.createElement('div');
      notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 transition-all duration-300 ${
        type === 'success' ? 'bg-green-500 text-white' : 'bg-red-500 text-white'
      }`;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 2000);
    }

