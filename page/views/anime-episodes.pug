extends layout

block content
  // Modern Hero Header Section
  section(class="bg-gradient-to-r from-dark-900 via-dark-800 to-dark-900 py-16 relative overflow-hidden")
    // Background Decorations
    div(class="absolute inset-0 overflow-hidden")
      div(class="absolute top-10 right-10 w-32 h-32 bg-primary-500/20 rounded-full filter blur-3xl")
      div(class="absolute bottom-10 left-10 w-24 h-24 bg-accent-500/20 rounded-full filter blur-2xl")
    
    div(class="container mx-auto px-6 relative z-10")
      div(class="text-center")
        div(class="inline-flex items-center px-4 py-2 bg-primary-600/20 text-primary-400 rounded-full text-sm font-medium mb-6 border border-primary-600/30")
          svg(class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24")
            path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z")
          span Episode List
        h1(class="text-4xl md:text-6xl font-black text-white mb-4")
          span(class="gradient-text") Daftar Episode
        p(class="text-xl text-gray-300 max-w-2xl mx-auto leading-relaxed") Tonton semua episode anime favorit Anda dengan subtitle Indonesia berkualitas tinggi

  // Main Content
  div(class="container mx-auto px-6 py-12")
    div(class="grid grid-cols-1 xl:grid-cols-4 gap-12")
      div(class="xl:col-span-3")
        // Breadcrumb Navigation
        nav(class="mb-8")
          ol(class="flex items-center space-x-2 text-sm text-gray-400")
            li: a(href="/" class="hover:text-primary-400 transition-colors") Beranda
            li: span(class="text-gray-600") /
            li: a(href=`/anime/${anime.slug}` class="hover:text-primary-400 transition-colors")= anime.title
            li: span(class="text-gray-600") /
            li(class="text-primary-400 font-medium") Episode List

        // Anime Info Card
        div(class="anime-card rounded-2xl p-8 mb-8")
          div(class="flex items-start space-x-6")
            img(src=anime.poster alt=anime.title class="w-32 h-40 object-cover rounded-xl flex-shrink-0 shadow-lg" onerror="this.onerror=null;this.src='https://placehold.co/400x600?text=No+Image';")
            div(class="flex-1")
              h1(class="text-2xl md:text-3xl font-bold text-white mb-3")= `Episode ${anime.title}`
              if anime.synopsis
                p(class="text-gray-300 text-sm leading-relaxed line-clamp-3 mb-4")= anime.synopsis
              div(class="flex items-center space-x-4")
                a(href=`/anime/${anime.slug}` class="btn-modern px-6 py-3 bg-primary-600 text-white rounded-xl hover:bg-primary-700 transition-all")
                  svg(class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                    path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18")
                  span Kembali ke Detail
                if episodes && episodes.length > 0
                  span(class="px-4 py-2 bg-accent-600/20 text-accent-400 rounded-full text-sm font-medium border border-accent-600/30")= `${episodes.length} Episode`

        // Episodes Grid
        if episodes && episodes.length > 0
          div(class="anime-card rounded-2xl p-8 mb-8")
            h2(class="text-2xl font-bold text-white mb-6 flex items-center")
              svg(class="w-6 h-6 mr-3 text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z")
              span Daftar Episode
            div(class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 gap-4")
              each episode in episodes
                a(href=`/anime/${anime.slug}/episode/${episode.episode}` class="episode-card group bg-dark-700/50 hover:bg-primary-600/20 border border-dark-600/50 hover:border-primary-500/30 rounded-xl p-4 text-center transition-all duration-300 hover:scale-105")
                  div(class="text-sm font-semibold text-white group-hover:text-primary-300 transition-colors") Episode #{episode.episode}
                  if episode.release_date
                    div(class="text-xs text-gray-400 mt-2")= episode.release_date
                  if episode.duration
                    div(class="text-xs text-gray-500 mt-1")= episode.duration

        else
          // Empty State
          div(class="anime-card rounded-2xl p-12 mb-8 text-center")
            svg(class="w-20 h-20 text-gray-500 mx-auto mb-6" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z")
            h3(class="text-2xl font-bold text-white mb-3") Belum ada episode
            p(class="text-gray-400 text-lg") Episode untuk anime ini belum tersedia

        // Ad Slots
        if adSlots && adSlots.contentBottom && adSlots.contentBottom.length > 0
          div(class="mb-8")
            each ad in adSlots.contentBottom
              div(class="ad-slot bg-dark-800/50 rounded-xl border border-dark-700/50")!= ad.content

      // Sidebar
      div(class="xl:col-span-1")
        // Top Ads
        if adSlots && adSlots.sidebarTop && adSlots.sidebarTop.length > 0
          div(class="mb-8")
            each ad in adSlots.sidebarTop
              div(class="ad-slot bg-dark-800/50 rounded-xl border border-dark-700/50")!= ad.content

        // Anime Info Card
        div(class="anime-card rounded-2xl p-6 mb-8")
          h3(class="text-xl font-bold text-white mb-6 flex items-center")
            svg(class="w-5 h-5 mr-3 text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
            span Informasi Anime
          div(class="space-y-4 text-sm")
            if anime.title
              div(class="flex justify-between items-center py-2 border-b border-dark-700/30")
                span(class="font-medium text-gray-300") Judul:
                span(class="text-white")= anime.title
            if anime.status
              div(class="flex justify-between items-center py-2 border-b border-dark-700/30")
                span(class="font-medium text-gray-300") Status:
                span(class="text-white")= anime.status
            if anime.release_year
              div(class="flex justify-between items-center py-2 border-b border-dark-700/30")
                span(class="font-medium text-gray-300") Tahun:
                span(class="text-white")= anime.release_year
            if episodes && episodes.length > 0
              div(class="flex justify-between items-center py-2")
                span(class="font-medium text-gray-300") Total Episode:
                span(class="text-white")= episodes.length

        // Quick Actions
        div(class="anime-card rounded-2xl p-6 mb-8")
          h3(class="text-xl font-bold text-white mb-6 flex items-center")
            svg(class="w-5 h-5 mr-3 text-primary-400" fill="none" stroke="currentColor" viewBox="0 0 24 24")
              path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16")
            span Aksi Cepat
          div(class="space-y-3")
            a(href=`/anime/${anime.slug}` class="flex items-center p-3 text-gray-300 hover:text-white hover:bg-dark-700/50 rounded-xl transition-all group")
              svg(class="w-5 h-5 mr-3 text-primary-400 group-hover:text-primary-300 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
              span Detail Anime
            if episodes && episodes.length > 0
              a(href=`/anime/${anime.slug}/episode/${episodes[0].episode === 0 ? 1 : episodes[0].episode}` class="flex items-center p-3 text-gray-300 hover:text-white hover:bg-dark-700/50 rounded-xl transition-all group")
                svg(class="w-5 h-5 mr-3 text-primary-400 group-hover:text-primary-300 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                  path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h1m4 0h1m-6 4h8m-9-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z")
                span Mulai Nonton
            if anime.batch_links && anime.batch_links.length > 0
              a(href=`/anime/${anime.slug}/batch` class="flex items-center p-3 text-gray-300 hover:text-white hover:bg-dark-700/50 rounded-xl transition-all group")
                svg(class="w-5 h-5 mr-3 text-primary-400 group-hover:text-primary-300 transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24")
                  path(stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z")
                span Download Batch

        // Bottom Ads
        if adSlots && adSlots.sidebarBottom && adSlots.sidebarBottom.length > 0
          div(class="mb-8")
            each ad in adSlots.sidebarBottom
              div(class="ad-slot bg-dark-800/50 rounded-xl border border-dark-700/50")!= ad.content

block scripts
  script.
    if ('IntersectionObserver' in window) {
      const episodeObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('animate-fadeIn');
            episodeObserver.unobserve(entry.target);
          }
        });
      });

      document.querySelectorAll('.episode-card').forEach(card => {
        episodeObserver.observe(card);
      });
    }
